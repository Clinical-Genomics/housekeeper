{% extends "layout.html" %}
{% import "components.html" as components %}

{% block main_content %}
  <form action="{{ url_for('cases') }}">
    <div class="card mb-3">
      <div class="card-block">
        <div class="row">
          <div class="col-10">
            <input class="form-control" type="text" name="query_str" value="{{ qargs.query_str if qargs.query_str }}">
          </div>
          <div class="col-2">
            <button class="btn btn-info form-control">Search</button>
          </div>
        </div>
      </div>
      <div class="card-footer">
        <select class="form-control" name="missing">
          <option value="empty">Show all cases</option>
          {% for status in ['analyzed', 'delivered', 'archived', 'cleanedup'] %}
            <option value="{{ status }}" {% if status == qargs.missing %}selected{% endif %}>Cases to {{ status }}</option>
          {% endfor %}
        </select>
      </div>
    </div>
  </form>

  {{ components.runs_table(cases=cases.items) }}

  <div class="card mb-3">
    <div class="card-block">
      <div class="row">
        <div class="col-4">
          {% if cases.has_prev %}
            <a href="{{ url_for('cases', page=cases.prev_num, **qargs) }}">Previous</a>
          {% endif %}
        </div>
        <div class="col-4 text-center">
          Page {{ cases.page }} <small class="text-muted">({{ cases.total }} cases)</small>
        </div>
        <div class="col-4 text-right">
          {% if cases.has_next %}
            <a href="{{ url_for('cases', page=cases.next_num, **qargs) }}">Next</a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
{% endblock %}
